# Learn more about services, parameters and containers at
# http://symfony.com/doc/current/book/service_container.html
parameters:
    app.user.success_handler.class: AppBundle\Authentication\SuccessHandler

services:
    twig.text_extension:
        class: Twig_Extensions_Extension_Text
        tags:
            - name: twig.extension

    templating.twig_asset_version_extension:
        class: AppBundle\Templating\Twig\AssetVersionExtension
        arguments: ["@templating.asset_version_resolver"]
        tags:
            - { name: twig.extension }

    templating.helper.asset_version:
        class: AppBundle\Templating\Helper\AssetVersionHelper
        arguments: ["@templating.asset_version_resolver"]
        tags:
            - { name: templating.helper, alias: asset_version}

    templating.asset_version_resolver:
        class: AppBundle\Templating\AssetVersionResolver
        arguments: ["%kernel.root_dir%"]

    app.user.success_handler:
        class: %app.user.success_handler.class%
        arguments: [@router]
        calls:
          - [setBackendUserRoles, [['ROLE_ADMIN', 'ROLE_SUPER_ADMIN']]]
          - [setAppProUserRoles, [['ROLE_EMPLOYEE']]]

    app.availability.finder:
        class: AppBundle\Availability\AvailabilityFinder
        arguments:
          - @=service('doctrine.orm.default_entity_manager').getRepository('AppBundle:Booking')
          - @=service('doctrine.orm.default_entity_manager').getRepository('AppBundle:Employee')